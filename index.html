<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EDOGRA - Toma de Pedidos</title>
    <style>
        :root {
            --azul-edogra: #007bff;
            --azul-oscuro: #0056b3;
            --blanco: #ffffff;
            --gris-claro: #f4f7f6;
            --verde-whatsapp: #25d366;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--gris-claro);
            margin: 0;
            padding: 10px;
        }

        .container {
            max-width: 600px;
            margin: auto;
            background: var(--blanco);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .header {
            text-align: center;
            margin-bottom: 20px;
        }

        /* Estilo para tu logo del repositorio */
        .logo {
            max-width: 150px;
            height: auto;
            margin-bottom: 10px;
        }

        .header h1 { color: var(--azul-edogra); margin: 0; text-transform: uppercase; }
        .datetime { font-size: 0.85em; color: #666; margin-top: 5px; }

        .form-group { margin-bottom: 12px; }
        label { display: block; font-weight: bold; margin-bottom: 3px; font-size: 0.9em; }
        
        input[type="text"], input[type="tel"], input[type="number"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 8px;
            box-sizing: border-box;
        }

        /* Buscador de productos */
        #searchBox {
            background-color: #fffde7;
            border: 2px solid var(--azul-edogra);
            margin-bottom: 15px;
            font-weight: bold;
        }

        .product-list { 
            margin-top: 10px; 
            max-height: 400px; 
            overflow-y: auto; 
            border: 1px solid #eee;
            padding: 5px;
        }

        .product-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 8px;
            border-bottom: 1px solid #f0f0f0;
        }

        .product-info { flex: 2; padding-right: 10px; }
        .product-name { font-weight: bold; font-size: 0.95em; display: block; }
        .product-detail { font-size: 0.85em; color: #555; }
        .product-price { color: var(--azul-oscuro); font-weight: bold; }

        .qty-input {
            width: 70px !important;
            text-align: center;
            border: 2px solid var(--azul-edogra) !important;
            font-size: 1.1em;
        }

        .footer-sticky {
            position: sticky;
            bottom: 0;
            background: white;
            padding: 15px;
            border-top: 3px solid var(--azul-edogra);
            box-shadow: 0 -2px 10px rgba(0,0,0,0.05);
        }

        .totals {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .total-amount { font-size: 1.4em; color: var(--azul-edogra); font-weight: bold; }

        .btn {
            display: block;
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            margin-bottom: 8px;
        }

        .btn-whatsapp { background-color: var(--verde-whatsapp); color: white; }
        .btn-backup { background-color: #6c757d; color: white; }

        .hidden { display: none !important; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <img src="logo.png" alt="Logo EDOGRA" class="logo">
        <h1>EDOGRA</h1>
        <div class="datetime" id="currentDateTime"></div>
    </div>

    <div class="form-group">
        <label>Cliente / Tienda</label>
        <input type="text" id="nombreCliente" placeholder="Nombre Cliente">
        <input type="text" id="nombreTienda" placeholder="Nombre de la Tienda" style="margin-top:5px">
    </div>
    <div class="form-group">
        <input type="text" id="direccion" placeholder="Direcci√≥n y Ciudad (Caucasia)">
    </div>
    <div class="form-group">
        <input type="text" id="vendedor" placeholder="Vendedor que atiende">
    </div>

    <hr>

    <label>üîç Buscar Producto:</label>
    <input type="text" id="searchBox" placeholder="Escribe el nombre del producto..." onkeyup="filterProducts()">

    <div class="product-list" id="productosContainer">
        </div>

    <div class="footer-sticky">
        <div class="totals">
            <span>SUBTOTAL: <span id="subtotalLabel">$0</span></span>
            <span class="total-amount" id="totalLabel">$0</span>
        </div>
        
        <button class="btn btn-whatsapp" onclick="enviarWhatsApp()">üöÄ ENVIAR PEDIDO (WHATSAPP)</button>
        <button class="btn btn-backup" onclick="guardarBackup()">üíæ GUARDAR BACKUP</button>
        
        <p style="text-align: center; font-size: 0.75em; color: #999; margin: 5px 0 0 0;">
            App Desarrollada por <b>Vibras Positivas</b>
        </p>
    </div>
</div>

<script>
    // LISTA COMPLETA EXTRA√çDA DE TUS FOTOS
    const PRODUCTOS = [
        // DETERGENTES
        { id: 101, n: "Detergente 3D *125GR", e: "PC*96", p: 1335 },
        { id: 102, n: "Detergente 3D *1KL", e: "PC*12", p: 7565 },
        { id: 103, n: "Detergente 3D *250GR", e: "PC*24", p: 2580 },
        { id: 104, n: "Detergente Fab *450GR", e: "PC*30", p: 5345 },
        { id: 105, n: "Detergente Ultrex *125GR", e: "PC*96", p: 755 },
        { id: 106, n: "Detergente Ultrex *1KL", e: "PC*20", p: 5560 },
        { id: 107, n: "Detergente Ultrex Manz *500GR", e: "PC*40", p: 2800 },
        // BLANQUEADORES / LIMPIAPISOS
        { id: 201, n: "Blanqueador Patojito *1000ML", e: "CJ*18", p: 51465 },
        { id: 202, n: "Blanqueador Patojito *1800ML", e: "CJ*12", p: 59545 },
        { id: 203, n: "Desmanc Ropa Blanca Pat *1000ML", e: "CJ*18", p: 6115 },
        { id: 204, n: "Desmanc Ropa Color Pat *450ML", e: "CJ*24", p: 2655 },
        // SUAVIZANTES
        { id: 301, n: "Suavizante Aromatel *900ML", e: "CJ*12", p: 8900 },
        { id: 302, n: "Suavizante Suavitel *1LT", e: "CJ*12", p: 8350 },
        { id: 303, n: "Suavizante Ultrex *900ML DP", e: "CJ*12", p: 4480 },
        { id: 304, n: "Suavizante Patojito *180ML", e: "CJ*48", p: 1200 },
        // JABONES / LAVALOZA
        { id: 401, n: "Jabon Caiman Azul *230GR", e: "CJ*25", p: 42225 },
        { id: 402, n: "Jabon Rey *300GR", e: "25 UND", p: 72555 },
        { id: 403, n: "Jabon Top Terra *230GR", e: "CJ*25", p: 65325 },
        { id: 404, n: "Lavaloza Axion Barra *150GR", e: "CJ*72", p: 2225 },
        { id: 405, n: "Lavaloza Axion Barra *450GR", e: "CJ*24", p: 6170 },
        { id: 406, n: "Lavaloza Patojito *235GR", e: "CJ*36", p: 2280 },
        { id: 407, n: "Lavaloza Liquido 123 *500ML", e: "CJ*12", p: 3195 }
    ];

    function updateDateTime() {
        const ahora = new Date();
        const opciones = { timeZone: 'America/Bogota', hour12: true, year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit' };
        document.getElementById('currentDateTime').innerText = ahora.toLocaleString('es-CO', opciones);
    }
    setInterval(updateDateTime, 60000);
    updateDateTime();

    const container = document.getElementById('productosContainer');
    function renderProducts() {
        PRODUCTOS.forEach(p => {
            const div = document.createElement('div');
            div.className = 'product-item';
            div.setAttribute('data-name', p.n.toLowerCase());
            div.innerHTML = `
                <div class="product-info">
                    <span class="product-name">${p.n}</span>
                    <span class="product-detail">${p.e} - <span class="product-price">$${p.p.toLocaleString()}</span></span>
                </div>
                <input type="number" class="qty-input" id="qty-${p.id}" oninput="calcularTotal()">
            `;
            container.appendChild(div);
        });
    }

    function filterProducts() {
        const query = document.getElementById('searchBox').value.toLowerCase();
        const items = document.querySelectorAll('.product-item');
        items.forEach(item => {
            const name = item.getAttribute('data-name');
            if (name.includes(query)) {
                item.classList.remove('hidden');
            } else {
                item.classList.add('hidden');
            }
        });
    }

    function calcularTotal() {
        let total = 0;
        PRODUCTOS.forEach(p => {
            const qty = document.getElementById(`qty-${p.id}`).value || 0;
            total += qty * p.p;
        });
        document.getElementById('subtotalLabel').innerText = `$${total.toLocaleString()}`;
        document.getElementById('totalLabel').innerText = `$${total.toLocaleString()}`;
        return total;
    }

    function enviarWhatsApp() {
        const cliente = document.getElementById('nombreCliente').value;
        const tienda = document.getElementById('nombreTienda').value;
        const fecha = document.getElementById('currentDateTime').innerText;
        const vendedor = document.getElementById('vendedor').value;

        if(!cliente || !tienda) return alert("Faltan datos del cliente");

        let mensaje = `*DISTRIBUIDORA EDOGRA - PEDIDO*\n`;
        mensaje += `--------------------------------\n`;
        mensaje += `*Fecha:* ${fecha}\n`;
        mensaje += `*Cliente:* ${cliente}\n`;
        mensaje += `*Tienda:* ${tienda}\n`;
        mensaje += `*Vendedor:* ${vendedor}\n`;
        mensaje += `--------------------------------\n`;

        let total = 0;
        PRODUCTOS.forEach(p => {
            const qty = document.getElementById(`qty-${p.id}`).value;
            if (qty > 0) {
                const sub = qty * p.p;
                mensaje += `‚úÖ ${p.n}\n   ${qty} x $${p.p.toLocaleString()} = *$${sub.toLocaleString()}*\n`;
                total += sub;
            }
        });

        if(total === 0) return alert("El pedido est√° vac√≠o");

        mensaje += `--------------------------------\n`;
        mensaje += `*TOTAL FACTURA: $${total.toLocaleString()}*\n`;
        mensaje += `--------------------------------\n`;
        mensaje += `¬°Gracias por confiar en nosotros!\n\n`;
        mensaje += `_App desarrollada por Vibras Positivas_`;

        window.open(`https://api.whatsapp.com/send?phone=57317849331&text=${encodeURIComponent(mensaje)}`, '_blank');
    }

    function guardarBackup() {
        const backup = {
            c: document.getElementById('nombreCliente').value,
            t: document.getElementById('nombreTienda').value,
            v: document.getElementById('vendedor').value,
            p: []
        };
        PRODUCTOS.forEach(p => {
            const q = document.getElementById(`qty-${p.id}`).value;
            if(q > 0) backup.p.push({id: p.id, q: q});
        });
        localStorage.setItem('backup_edogra', JSON.stringify(backup));
        alert("Backup guardado localmente.");
    }

    renderProducts();
</script>
</body>
</html>
